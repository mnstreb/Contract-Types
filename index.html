<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Construction Contract Types | Strategic Analysis Framework</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', 'Helvetica Neue', Arial, sans-serif;
            background: #ffffff;
            color: #2c3e50;
            line-height: 1.6;
        }

        /* Navigation */
        nav {
            background: #1a252f;
            color: white;
            padding: 0;
            position: sticky;
            top: 0;
            z-index: 1000;
            border-bottom: 3px solid #0066cc;
        }

        nav .container {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
        }

        nav h1 {
            font-size: 1.1em;
            font-weight: 600;
            padding: 20px 0;
            letter-spacing: 0.5px;
        }

        nav ul {
            list-style: none;
            display: flex;
            gap: 0;
        }

        nav a {
            color: white;
            text-decoration: none;
            padding: 20px 20px;
            transition: background 0.2s;
            font-weight: 500;
            font-size: 0.95em;
            display: block;
        }

        nav a:hover {
            background: rgba(255,255,255,0.1);
        }

        /* Sections */
        section {
            max-width: 1400px;
            margin: 0 auto;
            padding: 40px 40px;
            min-height: 100vh;
            max-height: 100vh;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            box-sizing: border-box;
        }

        section h2 {
            font-size: 1.6em;
            color: #1a252f;
            margin-bottom: 8px;
            font-weight: 600;
            border-bottom: 3px solid #0066cc;
            padding-bottom: 8px;
            flex-shrink: 0;
        }

        section .subtitle {
            color: #5a6c7d;
            margin-bottom: 20px;
            font-size: 0.95em;
            flex-shrink: 0;
        }

        /* Hero */
        #hero {
            background: linear-gradient(135deg, #1a252f 0%, #2c3e50 100%);
            color: white;
            text-align: center;
            padding: 0;
            border-bottom: 4px solid #0066cc;
            min-height: 100vh;
            max-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        #hero h1 {
            font-size: 2.5em;
            margin-bottom: 16px;
            font-weight: 600;
            letter-spacing: -0.5px;
        }

        #hero p {
            font-size: 1.05em;
            color: #cbd5e0;
            max-width: 800px;
            margin: 0 auto;
        }

        #hero .contract-types {
            margin-top: 20px;
            font-size: 0.9em;
            color: #a0aec0;
            letter-spacing: 2px;
        }

        /* Charts Sections */
        .chart-controls {
            background: #f8f9fa;
            padding: 16px;
            border-radius: 4px;
            border: 1px solid #dee2e6;
            margin-bottom: 16px;
            flex-shrink: 0;
        }

        .control-group {
            margin-bottom: 12px;
        }

        .control-group:last-child {
            margin-bottom: 0;
        }

        .control-label {
            font-weight: 600;
            color: #1a252f;
            margin-bottom: 8px;
            display: block;
            font-size: 0.85em;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .button-group {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        .metric-btn {
            padding: 8px 14px;
            border: 1px solid #cbd5e0;
            border-radius: 3px;
            background: white;
            color: #2c3e50;
            cursor: pointer;
            transition: all 0.2s;
            font-weight: 500;
            font-size: 0.85em;
        }

        .metric-btn:hover {
            border-color: #0066cc;
            color: #0066cc;
        }

        .metric-btn.active-x,
        .metric-btn.active {
            background: #0066cc;
            color: white;
            border-color: #0066cc;
        }

        .metric-btn.active-y {
            background: #2c3e50;
            color: white;
            border-color: #2c3e50;
        }

        .info-box {
            background: #e8f4f8;
            border-left: 4px solid #0066cc;
            padding: 10px 16px;
            border-radius: 3px;
            color: #2c3e50;
            font-size: 0.85em;
        }

        .chart-container {
            background: white;
            padding: 20px;
            border-radius: 4px;
            border: 1px solid #dee2e6;
            margin-bottom: 16px;
            flex: 1;
            display: flex;
            flex-direction: column;
            min-height: 0;
        }

        .chart-container canvas {
            max-height: 100%;
            flex: 1;
        }

        .chart-title {
            text-align: center;
            margin-bottom: 16px;
            color: #1a252f;
            font-size: 1.1em;
            font-weight: 600;
            flex-shrink: 0;
        }

        /* Legend Cards */
        .legend-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 12px;
            margin-top: 16px;
            flex-shrink: 0;
        }

        .legend-card {
            background: white;
            padding: 12px;
            border-radius: 3px;
            border-left: 4px solid;
            border-top: 1px solid #dee2e6;
            border-right: 1px solid #dee2e6;
            border-bottom: 1px solid #dee2e6;
        }

        .legend-card.tm { border-left-color: #0066cc; }
        .legend-card.tm-nte { border-left-color: #6366f1; }
        .legend-card.gmp { border-left-color: #f59e0b; }
        .legend-card.ffp { border-left-color: #dc2626; }

        .legend-title {
            font-weight: 600;
            color: #1a252f;
            margin-bottom: 4px;
            font-size: 0.95em;
        }

        .legend-desc {
            color: #5a6c7d;
            font-size: 0.85em;
        }

        /* Interactive Quiz */
        .quiz-container {
            background: white;
            padding: 24px;
            border-radius: 4px;
            border: 1px solid #dee2e6;
            flex: 1;
            display: flex;
            flex-direction: column;
            min-height: 0;
        }

        .quiz-progress {
            background: #f8f9fa;
            padding: 12px;
            border-radius: 3px;
            margin-bottom: 16px;
            border-left: 4px solid #0066cc;
            flex-shrink: 0;
        }

        .progress-bar-container {
            background: #e5e7eb;
            height: 6px;
            border-radius: 3px;
            overflow: hidden;
            margin-bottom: 8px;
        }

        .progress-bar {
            background: #0066cc;
            height: 100%;
            transition: width 0.3s ease;
        }

        .progress-text {
            font-size: 0.85em;
            color: #5a6c7d;
            font-weight: 600;
        }

        .question-container {
            flex: 1;
            overflow-y: auto;
            min-height: 0;
        }

        .question-title {
            font-size: 1.2em;
            color: #1a252f;
            margin-bottom: 8px;
            font-weight: 600;
        }

        .question-subtitle {
            color: #5a6c7d;
            margin-bottom: 20px;
            font-size: 0.95em;
        }

        .answer-options {
            display: grid;
            gap: 12px;
        }

        .answer-option {
            background: #f8f9fa;
            padding: 16px;
            border-radius: 4px;
            border: 2px solid #dee2e6;
            cursor: pointer;
            transition: all 0.2s;
        }

        .answer-option:hover {
            border-color: #0066cc;
            background: #e8f4f8;
        }

        .answer-option.selected {
            border-color: #0066cc;
            background: #e8f4f8;
            border-width: 3px;
        }

        .answer-title {
            font-weight: 600;
            color: #1a252f;
            margin-bottom: 6px;
            font-size: 1em;
        }

        .answer-description {
            color: #5a6c7d;
            font-size: 0.9em;
            line-height: 1.5;
        }

        .quiz-buttons {
            display: flex;
            gap: 12px;
            margin-top: 16px;
            justify-content: space-between;
            flex-shrink: 0;
        }

        .quiz-btn {
            padding: 10px 24px;
            border: none;
            border-radius: 3px;
            font-size: 0.9em;
            cursor: pointer;
            font-weight: 600;
            letter-spacing: 0.3px;
            transition: all 0.2s;
        }

        .quiz-btn.primary {
            background: #0066cc;
            color: white;
        }

        .quiz-btn.primary:hover {
            background: #0052a3;
        }

        .quiz-btn.primary:disabled {
            background: #cbd5e0;
            cursor: not-allowed;
        }

        .quiz-btn.secondary {
            background: #e5e7eb;
            color: #2c3e50;
        }

        .quiz-btn.secondary:hover {
            background: #cbd5e0;
        }

        .results-container {
            overflow-y: auto;
        }

        .recommended-contract {
            background: #e8f4f8;
            border-left: 4px solid #0066cc;
            padding: 20px;
            border-radius: 3px;
            margin-bottom: 16px;
        }

        .recommended-contract h3 {
            color: #1a252f;
            font-size: 1.3em;
            margin-bottom: 8px;
            font-weight: 600;
        }

        .recommended-contract .contract-name {
            font-size: 1.6em;
            color: #0066cc;
            font-weight: 700;
            margin-bottom: 12px;
        }

        .recommendation-reason {
            color: #2c3e50;
            line-height: 1.6;
            font-size: 0.95em;
        }

        .your-answers {
            background: #f8f9fa;
            padding: 16px;
            border-radius: 3px;
            margin-bottom: 16px;
        }

        .your-answers h4 {
            color: #1a252f;
            margin-bottom: 12px;
            font-weight: 600;
            font-size: 1em;
        }

        .answer-summary {
            display: grid;
            gap: 8px;
        }

        .answer-item {
            padding: 10px;
            background: white;
            border-radius: 3px;
            border-left: 3px solid #0066cc;
        }

        .answer-label {
            font-weight: 600;
            color: #1a252f;
            font-size: 0.85em;
            margin-bottom: 4px;
        }

        .answer-value {
            color: #5a6c7d;
            font-size: 0.9em;
        }

        .alternative-contracts {
            background: white;
            padding: 16px;
            border-radius: 3px;
            border: 1px solid #dee2e6;
        }

        .alternative-contracts h4 {
            color: #1a252f;
            margin-bottom: 12px;
            font-weight: 600;
            font-size: 1em;
        }

        .alternative-item {
            padding: 12px;
            background: #f8f9fa;
            border-radius: 3px;
            margin-bottom: 8px;
            border-left: 3px solid #6366f1;
        }

        .alternative-item:last-child {
            margin-bottom: 0;
        }

        .alternative-name {
            font-weight: 600;
            color: #1a252f;
            margin-bottom: 4px;
            font-size: 0.95em;
        }

        .alternative-reason {
            color: #5a6c7d;
            font-size: 0.85em;
            line-height: 1.5;
        }

        /* Cheat Sheet */
        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 3px;
            overflow: hidden;
            border: 1px solid #dee2e6;
            font-size: 0.85em;
        }

        .comparison-table th {
            background: #1a252f;
            color: white;
            padding: 10px;
            text-align: left;
            font-weight: 600;
            font-size: 0.9em;
            letter-spacing: 0.3px;
        }

        .comparison-table td {
            padding: 10px;
            border-bottom: 1px solid #dee2e6;
        }

        .comparison-table tr:hover {
            background: #f8f9fa;
        }

        .comparison-table tr:last-child td {
            border-bottom: none;
        }

        .table-wrapper {
            flex: 1;
            overflow: auto;
            min-height: 0;
        }

        .tm-col { border-left: 3px solid #0066cc; }
        .tm-nte-col { border-left: 3px solid #6366f1; }
        .gmp-col { border-left: 3px solid #f59e0b; }
        .ffp-col { border-left: 3px solid #dc2626; }

        .contract-col {
            background: #f8f9fa;
            font-weight: 600;
        }

        /* Red Flags */
        .red-flag-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 16px;
            flex: 1;
            overflow-y: auto;
        }

        .red-flag-item {
            background: white;
            border-left: 4px solid #dc2626;
            padding: 16px;
            border-radius: 3px;
            border-top: 1px solid #dee2e6;
            border-right: 1px solid #dee2e6;
            border-bottom: 1px solid #dee2e6;
        }

        .red-flag-title {
            font-weight: 600;
            color: #991b1b;
            margin-bottom: 8px;
            font-size: 0.95em;
        }

        .red-flag-desc {
            color: #5a6c7d;
            font-size: 0.85em;
            line-height: 1.5;
        }

        .key-principle {
            background: white;
            border-left: 4px solid #0066cc;
            padding: 20px;
            border-radius: 3px;
            margin-top: 16px;
            border-top: 1px solid #dee2e6;
            border-right: 1px solid #dee2e6;
            border-bottom: 1px solid #dee2e6;
            flex-shrink: 0;
        }

        .key-principle h3 {
            color: #1a252f;
            margin-bottom: 8px;
            font-size: 1.1em;
            font-weight: 600;
        }

        .key-principle p {
            color: #5a6c7d;
            line-height: 1.6;
            font-size: 0.95em;
        }

        ul {
            margin-left: 20px;
            margin-top: 8px;
        }

        li {
            margin-bottom: 6px;
            line-height: 1.5;
            color: #5a6c7d;
            font-size: 0.9em;
        }

        strong {
            color: #1a252f;
            font-weight: 600;
        }

        /* Print button */
        .action-btn {
            background: #0066cc;
            color: white;
            border: none;
            padding: 10px 24px;
            border-radius: 3px;
            font-size: 0.9em;
            cursor: pointer;
            font-weight: 600;
            margin-bottom: 16px;
            letter-spacing: 0.3px;
        }

        .action-btn:hover {
            background: #0052a3;
        }

        #overview {
            padding: 0;
        }

        .section-content-wrapper {
            flex: 1;
            display: flex;
            flex-direction: column;
            min-height: 0;
            overflow: hidden;
        }

        @media (max-width: 768px) {
            section {
                padding: 30px 20px;
            }

            nav .container {
                flex-direction: column;
                align-items: flex-start;
            }

            nav ul {
                width: 100%;
                flex-direction: column;
            }

            nav a {
                width: 100%;
                padding: 12px 20px;
            }

            #hero h1 {
                font-size: 1.8em;
            }

            section h2 {
                font-size: 1.4em;
            }

            .red-flag-grid {
                grid-template-columns: 1fr;
            }

            .legend-grid {
                grid-template-columns: 1fr;
            }

            .comparison-table {
                font-size: 0.75em;
            }

            .comparison-table th,
            .comparison-table td {
                padding: 8px;
            }
        }

        @media print {
            nav, .action-btn {
                display: none;
            }
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav>
        <div class="container">
            <h1>CONSTRUCTION CONTRACT TYPES | STRATEGIC ANALYSIS</h1>
            <ul>
                <li><a href="#overview">Overview</a></li>
                <li><a href="#scatter">Risk Analysis</a></li>
                <li><a href="#bars">Comparisons</a></li>
                <li><a href="#selector">Contract Selector</a></li>
                <li><a href="#reference">Reference</a></li>
                <li><a href="#considerations">Key Considerations</a></li>
            </ul>
        </div>
    </nav>

    <!-- Hero Section -->
    <section id="overview">
        <div id="hero">
            <h1>Construction Contract Type Selection</h1>
            <p>Strategic framework for procurement decision-making and risk allocation analysis</p>
            <p class="contract-types">TIME & MATERIALS | T&M WITH NTE | GUARANTEED MAXIMUM PRICE | FIRM FIXED PRICE</p>
        </div>
    </section>

    <!-- Scatter Plot Chart -->
    <section id="scatter">
        <h2>Risk-Benefit Analysis Matrix</h2>
        <p class="subtitle">Comparative analysis across multiple performance dimensions</p>

        <div class="chart-controls">
            <div class="control-group">
                <span class="control-label">X-Axis: Risk and Exposure Metrics</span>
                <div class="button-group" id="xButtons"></div>
            </div>
            <div class="control-group">
                <span class="control-label">Y-Axis: Benefit and Control Metrics</span>
                <div class="button-group" id="yButtons"></div>
            </div>
            <div class="info-box">
                <strong>X-Axis:</strong> <span id="xDesc"></span><br>
                <strong>Y-Axis:</strong> <span id="yDesc"></span>
            </div>
        </div>

        <div class="chart-container">
            <h3 class="chart-title" id="scatterTitle"></h3>
            <canvas id="scatterChart"></canvas>
        </div>

        <div class="legend-grid">
            <div class="legend-card tm">
                <div class="legend-title">Time & Materials (T&M)</div>
                <div class="legend-desc">Cost-plus reimbursement structure with full cost pass-through to client</div>
            </div>
            <div class="legend-card tm-nte">
                <div class="legend-title">T&M with Not-To-Exceed (NTE)</div>
                <div class="legend-desc">Cost-plus structure with contractual spending ceiling for budget protection</div>
            </div>
            <div class="legend-card gmp">
                <div class="legend-title">Guaranteed Maximum Price (GMP)</div>
                <div class="legend-desc">Cost-capped agreement with potential savings distribution between parties</div>
            </div>
            <div class="legend-card ffp">
                <div class="legend-title">Firm Fixed Price (FFP)</div>
                <div class="legend-desc">Lump sum contract with complete cost risk transfer to contractor</div>
            </div>
        </div>
    </section>

    <!-- Bar Charts -->
    <section id="bars">
        <h2>Comparative Risk Profiles</h2>
        <p class="subtitle">Client and contractor perspective analysis</p>

        <div class="button-group" id="barButtons"></div>

        <div class="info-box" style="margin-top: 20px;">
            <strong id="barMetricTitle"></strong><br>
            <span id="barMetricDescription"></span>
        </div>

        <div class="chart-container">
            <canvas id="barChart"></canvas>
        </div>
    </section>

    <!-- Interactive Contract Selector -->
    <section id="selector">
        <h2>Contract Selection Tool</h2>
        <p class="subtitle">Answer four questions to determine the optimal contract type for your project</p>

        <div class="quiz-container">
            <div class="quiz-progress">
                <div class="progress-bar-container">
                    <div class="progress-bar" id="progressBar"></div>
                </div>
                <div class="progress-text" id="progressText">Question 1 of 4</div>
            </div>

            <div class="question-container" id="questionContainer">
                <!-- Questions will be inserted here by JavaScript -->
            </div>

            <div class="quiz-buttons">
                <button class="quiz-btn secondary" id="backBtn" style="display: none;">Back</button>
                <button class="quiz-btn primary" id="nextBtn" disabled>Next</button>
            </div>
        </div>
    </section>

    <!-- Cheat Sheet -->
    <section id="reference">
        <h2>Quick Reference Matrix</h2>
        <p class="subtitle">Comprehensive comparison of contract type characteristics</p>

        <div style="text-align: center; flex-shrink: 0;">
            <button class="action-btn" onclick="window.print()">Print Reference Guide</button>
        </div>

        <div class="table-wrapper">
            <table class="comparison-table">
            <thead>
                <tr>
                    <th>Evaluation Factor</th>
                    <th class="tm-col">T&M</th>
                    <th class="tm-nte-col">T&M with NTE</th>
                    <th class="gmp-col">GMP</th>
                    <th class="ffp-col">FFP</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>Formal Designation</strong></td>
                    <td class="contract-col tm-col">Time & Materials</td>
                    <td class="contract-col tm-nte-col">Time & Materials with Not-To-Exceed</td>
                    <td class="contract-col gmp-col">Guaranteed Maximum Price</td>
                    <td class="contract-col ffp-col">Firm Fixed Price</td>
                </tr>
                <tr>
                    <td><strong>Required Design Completion</strong></td>
                    <td class="tm-col">0-30%</td>
                    <td class="tm-nte-col">30-50%</td>
                    <td class="gmp-col">60-80%</td>
                    <td class="ffp-col">90-100%</td>
                </tr>
                <tr>
                    <td><strong>Owner Cost Risk Exposure</strong></td>
                    <td class="tm-col">Substantial</td>
                    <td class="tm-nte-col">Capped</td>
                    <td class="gmp-col">Limited with Ceiling</td>
                    <td class="ffp-col">Minimal</td>
                </tr>
                <tr>
                    <td><strong>Contractor Cost Risk</strong></td>
                    <td class="tm-col">Minimal</td>
                    <td class="tm-nte-col">Moderate</td>
                    <td class="gmp-col">Significant</td>
                    <td class="ffp-col">Complete</td>
                </tr>
                <tr>
                    <td><strong>Typical Fee/Markup Range</strong></td>
                    <td class="tm-col">10-15%</td>
                    <td class="tm-nte-col">12-18%</td>
                    <td class="gmp-col">15-20%</td>
                    <td class="ffp-col">20-30%</td>
                </tr>
                <tr>
                    <td><strong>Procurement Timeline</strong></td>
                    <td class="tm-col">3-7 Days</td>
                    <td class="tm-nte-col">1-2 Weeks</td>
                    <td class="gmp-col">2-4 Weeks</td>
                    <td class="ffp-col">4-12 Weeks</td>
                </tr>
                <tr>
                    <td><strong>Scope Change Management</strong></td>
                    <td class="tm-col">Minimal Process</td>
                    <td class="tm-nte-col">Moderate Formality</td>
                    <td class="gmp-col">Formal Negotiation</td>
                    <td class="ffp-col">Extensive Process</td>
                </tr>
                <tr>
                    <td><strong>Owner Oversight Requirement</strong></td>
                    <td class="tm-col">Daily Monitoring</td>
                    <td class="tm-nte-col">Weekly Review</td>
                    <td class="gmp-col">Weekly Review</td>
                    <td class="ffp-col">Milestone Verification</td>
                </tr>
                <tr>
                    <td><strong>Cost Transparency Level</strong></td>
                    <td class="tm-col">Complete Visibility</td>
                    <td class="tm-nte-col">High Visibility</td>
                    <td class="gmp-col">Moderate Visibility</td>
                    <td class="ffp-col">Limited Visibility</td>
                </tr>
                <tr>
                    <td><strong>Contractor Execution Autonomy</strong></td>
                    <td class="tm-col">Limited</td>
                    <td class="tm-nte-col">Moderate</td>
                    <td class="gmp-col">Substantial</td>
                    <td class="ffp-col">Complete</td>
                </tr>
                <tr>
                    <td><strong>Optimal Application</strong></td>
                    <td class="tm-col">Undefined scope, renovation, discovery expected, strong PM capability</td>
                    <td class="tm-nte-col">Partial definition, budget constraint, moderate PM capability</td>
                    <td class="gmp-col">Substantial definition, collaborative approach, shared risk tolerance</td>
                    <td class="ffp-col">Complete definition, competitive procurement, fixed budget requirement</td>
                </tr>
                <tr>
                    <td><strong>Unsuitable Applications</strong></td>
                    <td class="tm-col">Fixed budget constraint, limited PM resources, low trust environment</td>
                    <td class="tm-nte-col">Unrealistic cap, complete design, highly defined scope</td>
                    <td class="gmp-col">Early-stage design, adversarial relationship, simple scope</td>
                    <td class="ffp-col">Incomplete design, significant unknowns, high change probability</td>
                </tr>
            </tbody>
        </table>
        </div>
    </section>

    <!-- Red Flags -->
    <section id="considerations">
        <h2>Critical Risk Factors and Considerations</h2>
        <p class="subtitle">Common implementation challenges and mitigation strategies</p>

        <div class="red-flag-grid">
            <div class="red-flag-item">
                <div class="red-flag-title">Premature FFP Implementation</div>
                <div class="red-flag-desc">
                    <strong>Issue:</strong> Organization proceeded with FFP procurement at 30% design completion. Contractors incorporated 40% contingency loading due to scope uncertainty.
                    <br><br>
                    <strong>Impact:</strong> Final cost exceeded T&M alternative by $2M. Extensive rework required due to design conflicts discovered during construction.
                    <br><br>
                    <strong>Mitigation:</strong> FFP requires 90%+ design completion. Maintain T&M or GMP approach until adequate scope definition is achieved.
                </div>
            </div>

            <div class="red-flag-item">
                <div class="red-flag-title">Insufficient PM Resources for T&M</div>
                <div class="red-flag-desc">
                    <strong>Issue:</strong> Part-time facilities manager unable to provide daily T&M contractor oversight. Invoice validation process inadequate. Cost tracking deficient.
                    <br><br>
                    <strong>Impact:</strong> Project exceeded initial estimate by 60%. Lack of accountability led to scope creep and efficiency losses.
                    <br><br>
                    <strong>Mitigation:</strong> T&M demands experienced, dedicated PM resources. Without adequate oversight capability, utilize GMP or FFP structures.
                </div>
            </div>

            <div class="red-flag-item">
                <div class="red-flag-title">Premature GMP Establishment</div>
                <div class="red-flag-desc">
                    <strong>Issue:</strong> GMP established at 45% design with substantial scope uncertainties. Contractor set maximum value with excessive contingency to manage risk.
                    <br><br>
                    <strong>Impact:</strong> "Guarantee" provided no meaningful budget protection. Effectively became expensive T&M arrangement.
                    <br><br>
                    <strong>Mitigation:</strong> GMP requires 60%+ design completion for meaningful cost ceiling. Earlier establishment results in inflated maximum price.
                </div>
            </div>

            <div class="red-flag-item">
                <div class="red-flag-title">Unrealistic NTE Cap Setting</div>
                <div class="red-flag-desc">
                    <strong>Issue:</strong> T&M NTE established based on aspirational budget rather than realistic estimate. Cap set below feasible execution cost.
                    <br><br>
                    <strong>Impact:</strong> Contractor reached cap at 70% completion. Work stoppage required negotiation of cap increase or contract termination.
                    <br><br>
                    <strong>Mitigation:</strong> NTE must reflect realistic cost estimate plus 15-20% contingency. Cap serves as protection, not target or wish.
                </div>
            </div>

            <div class="red-flag-item">
                <div class="red-flag-title">Inappropriate Contract Type Selection</div>
                <div class="red-flag-desc">
                    <strong>Issue:</strong> Historical renovation with significant unknown conditions procured as FFP. Discovery of unforeseen conditions generated 47 change orders.
                    <br><br>
                    <strong>Impact:</strong> Adversarial relationship developed. Extensive disputes over change order pricing and schedule impacts.
                    <br><br>
                    <strong>Mitigation:</strong> Match contract structure to project characteristics. Renovation and discovery scenarios require T&M or GMP flexibility.
                </div>
            </div>

            <div class="red-flag-item">
                <div class="red-flag-title">Inadequate Risk Allocation Documentation</div>
                <div class="red-flag-desc">
                    <strong>Issue:</strong> GMP executed without clear definition of specific risk allocation (site conditions, material escalation, permit delays).
                    <br><br>
                    <strong>Impact:</strong> First significant issue resulted in dispute over responsibility. Ambiguous contract terms led to litigation threat.
                    <br><br>
                    <strong>Mitigation:</strong> Comprehensive risk allocation matrix must be documented in contract. Clarity regarding responsibility for specific risk categories is essential.
                </div>
            </div>
        </div>

        <div class="key-principle">
            <h3>Fundamental Principle</h3>
            <p>
                Contract type selection must be driven by objective assessment of project readiness, organizational capability, budget constraints, and risk tolerance. The optimal contract structure aligns with actual project conditions rather than aspirational preferences. No contract type is universally superior; appropriateness is determined by specific project context and stakeholder capabilities. Successful procurement outcomes result from systematic alignment of contract structure with project characteristics and organizational capacity.
            </p>
        </div>
    </section>

    <script>
        // ============================================
        // INTERACTIVE QUIZ
        // ============================================

        const quizQuestions = [
            {
                id: 1,
                title: "Phase 1: Design Completion Status",
                subtitle: "What is the current level of design completion for your project?",
                options: [
                    {
                        id: "design_0_30",
                        title: "0-30% Design Complete",
                        description: "Conceptual phase with preliminary scope definition. Requirements continue to evolve during execution.",
                        scores: { tm: 4, tmnte: 2, gmp: 0, ffp: 0 }
                    },
                    {
                        id: "design_30_60",
                        title: "30-60% Design Complete",
                        description: "Schematic design phase with major systems identified. Sufficient definition for cost envelope estimation.",
                        scores: { tm: 2, tmnte: 4, gmp: 3, ffp: 0 }
                    },
                    {
                        id: "design_60_90",
                        title: "60-90% Design Complete",
                        description: "Design development phase with primary decisions finalized. Minor details under refinement.",
                        scores: { tm: 0, tmnte: 2, gmp: 4, ffp: 2 }
                    },
                    {
                        id: "design_90_100",
                        title: "90-100% Design Complete",
                        description: "Construction documents complete with full specifications. Scope fully defined and documented.",
                        scores: { tm: 0, tmnte: 0, gmp: 2, ffp: 4 }
                    }
                ]
            },
            {
                id: 2,
                title: "Phase 2: Budget Flexibility",
                subtitle: "What is your budget authorization and flexibility?",
                options: [
                    {
                        id: "budget_fixed",
                        title: "Fixed Budget Requirement",
                        description: "Board-approved allocation with no contingency. Financing or regulatory requirements mandate cost certainty.",
                        scores: { tm: 0, tmnte: 1, gmp: 3, ffp: 4 }
                    },
                    {
                        id: "budget_contingency",
                        title: "Budget with Contingency Reserve",
                        description: "Approved budget with 10-20% contingency allocation available for scope adjustments.",
                        scores: { tm: 1, tmnte: 3, gmp: 4, ffp: 2 }
                    },
                    {
                        id: "budget_flexible",
                        title: "Flexible Budget Authorization",
                        description: "Budget can be adjusted based on actual scope refinement and project requirements.",
                        scores: { tm: 4, tmnte: 3, gmp: 2, ffp: 0 }
                    }
                ]
            },
            {
                id: 3,
                title: "Phase 3: Project Management Capability",
                subtitle: "What level of internal PM resources do you have available?",
                options: [
                    {
                        id: "pm_comprehensive",
                        title: "Comprehensive PM Capability",
                        description: "Experienced construction management team available for daily oversight and cost monitoring.",
                        scores: { tm: 4, tmnte: 3, gmp: 2, ffp: 1 }
                    },
                    {
                        id: "pm_moderate",
                        title: "Moderate PM Capability",
                        description: "Capable of weekly progress reviews, change order management, and milestone verification.",
                        scores: { tm: 1, tmnte: 3, gmp: 4, ffp: 2 }
                    },
                    {
                        id: "pm_limited",
                        title: "Limited PM Resources",
                        description: "Contractor must manage day-to-day operations. Internal team focuses on milestone reviews only.",
                        scores: { tm: 0, tmnte: 1, gmp: 2, ffp: 4 }
                    }
                ]
            },
            {
                id: 4,
                title: "Phase 4: Scope Change Probability",
                subtitle: "What is the likelihood of scope changes during execution?",
                options: [
                    {
                        id: "change_high",
                        title: "High Change Probability",
                        description: "Renovation projects, phased design, or significant unknowns. Discovery expected during execution.",
                        scores: { tm: 4, tmnte: 3, gmp: 2, ffp: 0 }
                    },
                    {
                        id: "change_moderate",
                        title: "Moderate Change Expectation",
                        description: "Minor refinements anticipated. Core scope stable with potential for limited adjustments.",
                        scores: { tm: 2, tmnte: 3, gmp: 4, ffp: 1 }
                    },
                    {
                        id: "change_low",
                        title: "Stable Scope Definition",
                        description: "Complete design with minimal anticipated changes. Requirements thoroughly documented and validated.",
                        scores: { tm: 0, tmnte: 1, gmp: 2, ffp: 4 }
                    }
                ]
            }
        ];

        let currentQuestion = 0;
        let answers = {};
        let scores = { tm: 0, tmnte: 0, gmp: 0, ffp: 0 };

        function renderQuestion() {
            const question = quizQuestions[currentQuestion];
            const container = document.getElementById('questionContainer');
            
            let html = `
                <div class="question-title">${question.title}</div>
                <div class="question-subtitle">${question.subtitle}</div>
                <div class="answer-options">
            `;

            question.options.forEach(option => {
                const selected = answers[question.id] === option.id ? 'selected' : '';
                html += `
                    <div class="answer-option ${selected}" onclick="selectAnswer(${question.id}, '${option.id}')">
                        <div class="answer-title">${option.title}</div>
                        <div class="answer-description">${option.description}</div>
                    </div>
                `;
            });

            html += '</div>';
            container.innerHTML = html;

            // Update progress
            const progress = ((currentQuestion + 1) / quizQuestions.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('progressText').textContent = `Question ${currentQuestion + 1} of ${quizQuestions.length}`;

            // Update buttons
            document.getElementById('backBtn').style.display = currentQuestion > 0 ? 'block' : 'none';
            document.getElementById('nextBtn').disabled = !answers[question.id];
            document.getElementById('nextBtn').textContent = currentQuestion === quizQuestions.length - 1 ? 'View Results' : 'Next';
        }

        function selectAnswer(questionId, optionId) {
            answers[questionId] = optionId;
            renderQuestion();
        }

        function goNext() {
            if (currentQuestion < quizQuestions.length - 1) {
                currentQuestion++;
                renderQuestion();
            } else {
                calculateResults();
            }
        }

        function goBack() {
            if (currentQuestion > 0) {
                currentQuestion--;
                renderQuestion();
            }
        }

        function calculateResults() {
            // Reset scores
            scores = { tm: 0, tmnte: 0, gmp: 0, ffp: 0 };

            // Calculate total scores
            quizQuestions.forEach(question => {
                const answerId = answers[question.id];
                const option = question.options.find(opt => opt.id === answerId);
                if (option) {
                    scores.tm += option.scores.tm;
                    scores.tmnte += option.scores.tmnte;
                    scores.gmp += option.scores.gmp;
                    scores.ffp += option.scores.ffp;
                }
            });

            displayResults();
        }

        function displayResults() {
            // Find recommended contract (highest score)
            const maxScore = Math.max(scores.tm, scores.tmnte, scores.gmp, scores.ffp);
            let recommended = '';
            let recommendedFull = '';
            let reason = '';

            if (scores.tm === maxScore) {
                recommended = 'T&M';
                recommendedFull = 'Time & Materials';
                reason = 'Your project characteristics indicate a Time & Materials contract is optimal. This approach provides maximum flexibility for your early-stage design and evolving scope. Your strong PM capability ensures appropriate cost oversight, and your budget flexibility accommodates the cost uncertainty inherent in T&M contracts.';
            } else if (scores.tmnte === maxScore) {
                recommended = 'T&M with NTE';
                recommendedFull = 'Time & Materials with Not-To-Exceed';
                reason = 'Your project profile suggests a T&M with Not-To-Exceed structure. This provides the flexibility needed for your partially defined scope while protecting your budget through a contractual spending ceiling. This balanced approach aligns with your moderate design completion and budget constraints.';
            } else if (scores.gmp === maxScore) {
                recommended = 'GMP';
                recommendedFull = 'Guaranteed Maximum Price';
                reason = 'A Guaranteed Maximum Price contract is recommended for your project. Your design is sufficiently developed to establish a meaningful cost ceiling, and this structure provides budget protection while maintaining some scope flexibility. The potential for shared savings aligns contractor and owner incentives toward cost efficiency.';
            } else {
                recommended = 'FFP';
                recommendedFull = 'Firm Fixed Price';
                reason = 'A Firm Fixed Price contract is the optimal choice for your project. Your complete design documentation eliminates scope ambiguity, enabling accurate contractor pricing. Your fixed budget requirement and stable scope make FFP the most appropriate structure. This approach provides maximum cost certainty and minimizes owner risk.';
            }

            // Get alternative contracts
            const sortedContracts = [
                { name: 'T&M', full: 'Time & Materials', score: scores.tm },
                { name: 'T&M W/NTE', full: 'Time & Materials with NTE', score: scores.tmnte },
                { name: 'GMP', full: 'Guaranteed Maximum Price', score: scores.gmp },
                { name: 'FFP', full: 'Firm Fixed Price', score: scores.ffp }
            ].sort((a, b) => b.score - a.score);

            const alternatives = sortedContracts.slice(1, 3);

            // Build answer summary
            let answerSummary = '';
            quizQuestions.forEach(question => {
                const answerId = answers[question.id];
                const option = question.options.find(opt => opt.id === answerId);
                if (option) {
                    answerSummary += `
                        <div class="answer-item">
                            <div class="answer-label">${question.title}</div>
                            <div class="answer-value">${option.title}</div>
                        </div>
                    `;
                }
            });

            // Display results
            const container = document.getElementById('questionContainer');
            container.innerHTML = `
                <div class="results-container">
                    <div class="recommended-contract">
                        <h3>Recommended Contract Type</h3>
                        <div class="contract-name">${recommendedFull}</div>
                        <div class="recommendation-reason">${reason}</div>
                    </div>

                    <div class="your-answers">
                        <h4>Your Project Profile</h4>
                        <div class="answer-summary">
                            ${answerSummary}
                        </div>
                    </div>

                    <div class="alternative-contracts">
                        <h4>Alternative Considerations</h4>
                        ${alternatives.map(alt => {
                            let altReason = '';
                            if (alt.name === 'T&M') {
                                altReason = 'Consider if scope definition decreases or if greater flexibility is required during execution.';
                            } else if (alt.name === 'T&M W/NTE') {
                                altReason = 'Consider if you need more flexibility than GMP provides but require budget protection.';
                            } else if (alt.name === 'GMP') {
                                altReason = 'Consider if you want to balance cost certainty with some scope flexibility and shared savings potential.';
                            } else {
                                altReason = 'Consider if your design completion increases or if you need complete cost certainty.';
                            }
                            return `
                                <div class="alternative-item">
                                    <div class="alternative-name">${alt.full} (Score: ${alt.score})</div>
                                    <div class="alternative-reason">${altReason}</div>
                                </div>
                            `;
                        }).join('')}
                    </div>
                </div>
            `;

            // Update button
            document.getElementById('backBtn').style.display = 'none';
            document.getElementById('nextBtn').textContent = 'Start Over';
            document.getElementById('nextBtn').disabled = false;
            document.getElementById('nextBtn').onclick = resetQuiz;
        }

        function resetQuiz() {
            currentQuestion = 0;
            answers = {};
            scores = { tm: 0, tmnte: 0, gmp: 0, ffp: 0 };
            document.getElementById('nextBtn').onclick = goNext;
            renderQuestion();
        }

        // Initialize quiz
        document.getElementById('nextBtn').addEventListener('click', goNext);
        document.getElementById('backBtn').addEventListener('click', goBack);
        renderQuestion();

        // ============================================
        // SCATTER PLOT CHART
        // ============================================

        const scatterMetrics = {
            costRisk: { label: 'Cost Risk for Contractor', description: 'Higher values indicate increased financial risk exposure for contractor', type: 'x' },
            scheduleRisk: { label: 'Schedule Risk for Contractor', description: 'Higher values indicate increased schedule performance risk and potential penalties', type: 'x' },
            clientCostExposure: { label: 'Client Cost Exposure', description: 'Higher values indicate increased cost uncertainty and budget risk for client', type: 'x' },
            changeOrderComplexity: { label: 'Change Order Complexity', description: 'Higher values indicate increased difficulty and administrative burden for scope changes', type: 'x' },
            projectDefinitionReadiness: { label: 'Project Definition Readiness Required', description: 'Higher values indicate greater project maturity needed including design completion, scope clarity, and owner confidence', type: 'x' },
            costBenefit: { label: 'Contractor Profit Potential', description: 'Higher values indicate greater opportunity for contractor profit margins', type: 'y' },
            scheduleBenefit: { label: 'Schedule Flexibility', description: 'Higher values indicate greater flexibility in schedule management and sequencing', type: 'y' },
            clientCostControl: { label: 'Client Cost Control', description: 'Higher values indicate better cost predictability and budget certainty for client', type: 'y' },
            clientScheduleEnforcement: { label: 'Client Schedule Enforcement', description: 'Higher values indicate stronger ability to enforce schedule requirements', type: 'y' },
            contractorAutonomy: { label: 'Contractor Execution Autonomy', description: 'Higher values indicate greater contractor control over means, methods, and project sequencing', type: 'y' }
        };

        const scatterData = {
            costRisk_costBenefit: [
                { name: 'T&M', x: 2, y: 4, color: '#0066cc' },
                { name: 'T&M W/NTE', x: 4, y: 5, color: '#6366f1' },
                { name: 'GMP', x: 6, y: 7, color: '#f59e0b' },
                { name: 'FFP', x: 9, y: 8, color: '#dc2626' }
            ],
            scheduleRisk_scheduleBenefit: [
                { name: 'T&M', x: 2, y: 8, color: '#0066cc' },
                { name: 'T&M W/NTE', x: 4, y: 6, color: '#6366f1' },
                { name: 'GMP', x: 7, y: 4, color: '#f59e0b' },
                { name: 'FFP', x: 9, y: 2, color: '#dc2626' }
            ],
            clientCostExposure_clientCostControl: [
                { name: 'T&M', x: 9, y: 2, color: '#0066cc' },
                { name: 'T&M W/NTE', x: 6, y: 5, color: '#6366f1' },
                { name: 'GMP', x: 4, y: 7, color: '#f59e0b' },
                { name: 'FFP', x: 1, y: 9, color: '#dc2626' }
            ],
            changeOrderComplexity_scheduleBenefit: [
                { name: 'T&M', x: 1, y: 8, color: '#0066cc' },
                { name: 'T&M W/NTE', x: 3, y: 6, color: '#6366f1' },
                { name: 'GMP', x: 5, y: 4, color: '#f59e0b' },
                { name: 'FFP', x: 8, y: 2, color: '#dc2626' }
            ],
            scheduleRisk_clientScheduleEnforcement: [
                { name: 'T&M', x: 2, y: 2, color: '#0066cc' },
                { name: 'T&M W/NTE', x: 4, y: 4, color: '#6366f1' },
                { name: 'GMP', x: 7, y: 7, color: '#f59e0b' },
                { name: 'FFP', x: 9, y: 9, color: '#dc2626' }
            ],
            costRisk_clientCostControl: [
                { name: 'T&M', x: 2, y: 2, color: '#0066cc' },
                { name: 'T&M W/NTE', x: 4, y: 5, color: '#6366f1' },
                { name: 'GMP', x: 6, y: 7, color: '#f59e0b' },
                { name: 'FFP', x: 9, y: 9, color: '#dc2626' }
            ],
            projectDefinitionReadiness_costBenefit: [
                { name: 'T&M', x: 2, y: 4, color: '#0066cc' },
                { name: 'T&M W/NTE', x: 4, y: 5, color: '#6366f1' },
                { name: 'GMP', x: 7, y: 7, color: '#f59e0b' },
                { name: 'FFP', x: 9, y: 8, color: '#dc2626' }
            ],
            projectDefinitionReadiness_scheduleBenefit: [
                { name: 'T&M', x: 2, y: 8, color: '#0066cc' },
                { name: 'T&M W/NTE', x: 4, y: 6, color: '#6366f1' },
                { name: 'GMP', x: 7, y: 4, color: '#f59e0b' },
                { name: 'FFP', x: 9, y: 2, color: '#dc2626' }
            ],
            projectDefinitionReadiness_clientCostControl: [
                { name: 'T&M', x: 2, y: 2, color: '#0066cc' },
                { name: 'T&M W/NTE', x: 4, y: 5, color: '#6366f1' },
                { name: 'GMP', x: 7, y: 7, color: '#f59e0b' },
                { name: 'FFP', x: 9, y: 9, color: '#dc2626' }
            ],
            projectDefinitionReadiness_clientScheduleEnforcement: [
                { name: 'T&M', x: 2, y: 2, color: '#0066cc' },
                { name: 'T&M W/NTE', x: 4, y: 4, color: '#6366f1' },
                { name: 'GMP', x: 7, y: 7, color: '#f59e0b' },
                { name: 'FFP', x: 9, y: 9, color: '#dc2626' }
            ],
            costRisk_contractorAutonomy: [
                { name: 'T&M', x: 2, y: 2, color: '#0066cc' },
                { name: 'T&M W/NTE', x: 4, y: 4, color: '#6366f1' },
                { name: 'GMP', x: 6, y: 7, color: '#f59e0b' },
                { name: 'FFP', x: 9, y: 9, color: '#dc2626' }
            ],
            scheduleRisk_contractorAutonomy: [
                { name: 'T&M', x: 2, y: 2, color: '#0066cc' },
                { name: 'T&M W/NTE', x: 4, y: 4, color: '#6366f1' },
                { name: 'GMP', x: 7, y: 7, color: '#f59e0b' },
                { name: 'FFP', x: 9, y: 9, color: '#dc2626' }
            ],
            clientCostExposure_contractorAutonomy: [
                { name: 'T&M', x: 9, y: 2, color: '#0066cc' },
                { name: 'T&M W/NTE', x: 6, y: 4, color: '#6366f1' },
                { name: 'GMP', x: 4, y: 7, color: '#f59e0b' },
                { name: 'FFP', x: 1, y: 9, color: '#dc2626' }
            ],
            changeOrderComplexity_contractorAutonomy: [
                { name: 'T&M', x: 1, y: 2, color: '#0066cc' },
                { name: 'T&M W/NTE', x: 3, y: 4, color: '#6366f1' },
                { name: 'GMP', x: 5, y: 7, color: '#f59e0b' },
                { name: 'FFP', x: 8, y: 9, color: '#dc2626' }
            ],
            projectDefinitionReadiness_contractorAutonomy: [
                { name: 'T&M', x: 2, y: 2, color: '#0066cc' },
                { name: 'T&M W/NTE', x: 4, y: 4, color: '#6366f1' },
                { name: 'GMP', x: 7, y: 7, color: '#f59e0b' },
                { name: 'FFP', x: 9, y: 9, color: '#dc2626' }
            ]
        };

        let currentScatterX = 'costRisk';
        let currentScatterY = 'costBenefit';
        let scatterChart;

        function createScatterButtons() {
            const xContainer = document.getElementById('xButtons');
            const yContainer = document.getElementById('yButtons');

            Object.entries(scatterMetrics).forEach(([key, value]) => {
                const button = document.createElement('button');
                button.className = 'metric-btn';
                button.textContent = value.label;
                
                if (value.type === 'x') {
                    button.onclick = () => {
                        currentScatterX = key;
                        updateScatterChart();
                        updateScatterButtons();
                    };
                    xContainer.appendChild(button);
                } else {
                    button.onclick = () => {
                        currentScatterY = key;
                        updateScatterChart();
                        updateScatterButtons();
                    };
                    yContainer.appendChild(button);
                }
            });

            updateScatterButtons();
        }

        function updateScatterButtons() {
            document.querySelectorAll('#xButtons .metric-btn, #yButtons .metric-btn').forEach(btn => {
                btn.classList.remove('active-x', 'active-y');
            });

            const xButtons = document.getElementById('xButtons').querySelectorAll('.metric-btn');
            const yButtons = document.getElementById('yButtons').querySelectorAll('.metric-btn');

            const xIndex = Object.keys(scatterMetrics).filter(k => scatterMetrics[k].type === 'x').indexOf(currentScatterX);
            const yIndex = Object.keys(scatterMetrics).filter(k => scatterMetrics[k].type === 'y').indexOf(currentScatterY);

            if (xButtons[xIndex]) xButtons[xIndex].classList.add('active-x');
            if (yButtons[yIndex]) yButtons[yIndex].classList.add('active-y');

            document.getElementById('xDesc').textContent = scatterMetrics[currentScatterX].description;
            document.getElementById('yDesc').textContent = scatterMetrics[currentScatterY].description;
        }

        function updateScatterChart() {
            const key = `${currentScatterX}_${currentScatterY}`;
            const data = scatterData[key] || scatterData.costRisk_costBenefit;

            document.getElementById('scatterTitle').textContent = 
                `${scatterMetrics[currentScatterX].label} vs ${scatterMetrics[currentScatterY].label}`;

            const chartData = {
                datasets: data.map(point => ({
                    label: point.name,
                    data: [{ x: point.x, y: point.y }],
                    backgroundColor: point.color,
                    borderColor: '#ffffff',
                    borderWidth: 2,
                    pointRadius: 10,
                    pointHoverRadius: 12
                }))
            };

            const config = {
                type: 'scatter',
                data: chartData,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            backgroundColor: 'rgba(255, 255, 255, 0.98)',
                            titleColor: '#1a252f',
                            bodyColor: '#2c3e50',
                            borderColor: '#cbd5e0',
                            borderWidth: 1,
                            padding: 14,
                            displayColors: false,
                            titleFont: { size: 14, weight: 'bold' },
                            bodyFont: { size: 13 },
                            callbacks: {
                                title: (context) => context[0].dataset.label,
                                label: (context) => [
                                    `${scatterMetrics[currentScatterX].label}: ${context.parsed.x}`,
                                    `${scatterMetrics[currentScatterY].label}: ${context.parsed.y}`
                                ]
                            }
                        }
                    },
                    scales: {
                        x: {
                            min: 0,
                            max: 10,
                            ticks: { stepSize: 2, color: '#5a6c7d', font: { size: 12 } },
                            title: {
                                display: true,
                                text: scatterMetrics[currentScatterX].label,
                                color: '#1a252f',
                                font: { weight: 'bold', size: 13 }
                            },
                            grid: { color: '#e5e7eb' }
                        },
                        y: {
                            min: 0,
                            max: 10,
                            ticks: { stepSize: 2, color: '#5a6c7d', font: { size: 12 } },
                            title: {
                                display: true,
                                text: scatterMetrics[currentScatterY].label,
                                color: '#1a252f',
                                font: { weight: 'bold', size: 13 }
                            },
                            grid: { color: '#e5e7eb' }
                        }
                    }
                }
            };

            if (scatterChart) scatterChart.destroy();
            const ctx = document.getElementById('scatterChart').getContext('2d');
            scatterChart = new Chart(ctx, config);
        }

        // ============================================
        // BAR CHART
        // ============================================

        const barMetrics = {
            costCertainty: {
                title: 'Cost Certainty Analysis',
                description: 'Higher values indicate greater cost predictability and reduced budget risk',
                data: [
                    { name: 'FFP', client: 95, contractor: 85 },
                    { name: 'GMP', client: 80, contractor: 60 },
                    { name: 'T&M W/NTE', client: 65, contractor: 45 },
                    { name: 'T&M', client: 20, contractor: 15 }
                ]
            },
            scheduleEnforceability: {
                title: 'Schedule Enforceability Assessment',
                description: 'Higher values indicate stricter schedule requirements and greater contractor accountability',
                data: [
                    { name: 'FFP', client: 90, contractor: 90 },
                    { name: 'GMP', client: 70, contractor: 70 },
                    { name: 'T&M W/NTE', client: 40, contractor: 40 },
                    { name: 'T&M', client: 20, contractor: 20 }
                ]
            },
            projectDefinitionReadiness: {
                title: 'Project Definition Readiness Requirements',
                description: 'Higher values indicate greater project maturity required (design completion, scope definition, stakeholder confidence)',
                data: [
                    { name: 'FFP', client: 90, contractor: 90 },
                    { name: 'GMP', client: 70, contractor: 70 },
                    { name: 'T&M W/NTE', client: 40, contractor: 40 },
                    { name: 'T&M', client: 20, contractor: 20 }
                ]
            },
            contractorAutonomy: {
                title: 'Execution Control Distribution',
                description: 'Comparative analysis of contractor autonomy versus client control over means, methods, and sequencing',
                data: [
                    { name: 'FFP', client: 10, contractor: 90 },
                    { name: 'GMP', client: 30, contractor: 70 },
                    { name: 'T&M W/NTE', client: 60, contractor: 40 },
                    { name: 'T&M', client: 85, contractor: 15 }
                ]
            }
        };

        let currentBarMetric = 'costCertainty';
        let barChart;

        function createBarButtons() {
            const container = document.getElementById('barButtons');
            
            Object.keys(barMetrics).forEach(key => {
                const button = document.createElement('button');
                button.className = 'metric-btn';
                button.textContent = barMetrics[key].title;
                button.onclick = () => {
                    currentBarMetric = key;
                    updateBarChart();
                    updateBarButtons();
                };
                container.appendChild(button);
            });

            updateBarButtons();
        }

        function updateBarButtons() {
            const buttons = document.querySelectorAll('#barButtons .metric-btn');
            buttons.forEach((btn, index) => {
                const metricKey = Object.keys(barMetrics)[index];
                if (metricKey === currentBarMetric) {
                    btn.classList.add('active');
                } else {
                    btn.classList.remove('active');
                }
            });

            document.getElementById('barMetricTitle').textContent = barMetrics[currentBarMetric].title;
            document.getElementById('barMetricDescription').textContent = barMetrics[currentBarMetric].description;
        }

        function updateBarChart() {
            const data = barMetrics[currentBarMetric].data;

            const chartData = {
                labels: data.map(d => d.name),
                datasets: [
                    {
                        label: currentBarMetric === 'contractorAutonomy' ? 'Client Control' : 
                               currentBarMetric === 'projectDefinitionReadiness' ? 'Requirement Level' : 
                               'Client Risk/Certainty',
                        data: data.map(d => d.client),
                        backgroundColor: '#0066cc',
                        borderRadius: 4,
                        borderSkipped: false
                    },
                    {
                        label: currentBarMetric === 'contractorAutonomy' ? 'Contractor Autonomy' : 
                               currentBarMetric === 'projectDefinitionReadiness' ? 'Requirement Level' : 
                               'Contractor Risk/Certainty',
                        data: data.map(d => d.contractor),
                        backgroundColor: '#2c3e50',
                        borderRadius: 4,
                        borderSkipped: false
                    }
                ]
            };

            const config = {
                type: 'bar',
                data: chartData,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: true,
                            position: 'top',
                            labels: {
                                padding: 20,
                                font: { size: 13, weight: '600' },
                                usePointStyle: true,
                                pointStyle: 'rect'
                            }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(255, 255, 255, 0.98)',
                            titleColor: '#1a252f',
                            bodyColor: '#2c3e50',
                            borderColor: '#cbd5e0',
                            borderWidth: 1,
                            padding: 12,
                            displayColors: true
                        }
                    },
                    scales: {
                        x: {
                            ticks: { color: '#5a6c7d', font: { weight: '600', size: 12 } },
                            grid: { display: false }
                        },
                        y: {
                            min: 0,
                            max: 100,
                            ticks: { stepSize: 20, color: '#5a6c7d' },
                            title: {
                                display: true,
                                text: 'Assessment Value (0-100 Scale)',
                                color: '#1a252f',
                                font: { weight: '600', size: 13 }
                            },
                            grid: { color: '#e5e7eb' }
                        }
                    }
                }
            };

            if (barChart) barChart.destroy();
            const ctx = document.getElementById('barChart').getContext('2d');
            barChart = new Chart(ctx, config);
        }

        // Initialize charts
        createScatterButtons();
        updateScatterChart();
        createBarButtons();
        updateBarChart();

        // Smooth scrolling for navigation links
        document.querySelectorAll('nav a').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }
            });
        });
    </script>
</body>
</html>
